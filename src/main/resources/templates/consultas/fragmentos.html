<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity-6">
    <head th:replace="~{general/plantilla :: head}"/>


    <!-- fragmento 1 para mostrar en tabs las categorias -->
    <section th:fragment="tabs" class='py-3 mb-4'>
        <div class='d-flex justify-content-center px-5'>
            <ul class="nav nav-underline">
                <li class="nav-item">
                    <a class="nav-link" aria-current="page"
                       href="/">[[#{pruebas.todas}]]</a>
                </li>
                <li th:each='c : ${categorias}' class="nav-item">
                    <a class="nav-link"
                       th:href="@{/consultas/{id}(id=${c.idCategoria})}">
                        [[${c.descripcion}]] </a>
                </li>
            </ul>
        </div>
    </section>


    <!-- fragmento 2 para mostrar en tarjetas los productos -->
    <section th:fragment="tarjetas" class='container py-4'>
        <div class='row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 g-4'>
            <div th:each='p : ${productos}' class='col'>

                <div class="card h-100 shadow">

                    <!-- Imagen centrada -->
                    <div class='d-flex justify-content-center align-items-center bg-light p-3'
                         style="height: 200px;">
                        <img th:src="${p.rutaImagen}" class="img-fluid"
                             style="max-height: 100%; max-width: 100%; object-fit: contain"
                             alt="..." />
                    </div>

                    <!-- Título -->
                    <div class="card-header bg-white">
                        <h5 class="card-title text-center text-truncate mb-0"
                            th:text="${p.descripcion}">Título</h5>
                    </div>

                    <!-- Detalle -->
                    <div class="card-body d-flex flex-column">
                        <p class="card-text text-muted mb-auto text-truncate"
                           th:text="${p.detalle}">Detalle.</p>
                    </div>

                    <!-- Precio + Existencias -->
                    <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                        <div class="fw-bold">

                            <!-- Precio -->
                            <span class="text-success h5"
                                  th:text="${#numbers.formatCurrency(p.precio)}">99.99</span>

                            <!-- Existencias (verde si hay, rojo si no) -->
                            <span th:if="${p.existencias > 0}"
                                  class="badge text-bg-success ms-2"
                                  th:text="${p.existencias + ' unidades'}">unidades</span>

                            <span th:unless="${p.existencias > 0}"
                                  class="badge text-bg-danger ms-2"
                                  th:text="'Agotado'">Agotado</span>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>

</body>
</html>
